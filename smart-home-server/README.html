

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart home server &mdash; Eccles 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="zed editor" href="../zed/README.html" />
    <link rel="prev" title="Proxmox" href="../proxmox/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../backups/README.html">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../baremetal/README.html">Bare Metal Installation Fedora Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../btrfs/README.html">Notes on btrfs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macbookPro/README.html">Installing Linux on Macbook Pro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../private-github/README.html">Accessing private github golang repos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proxmox/README.html">Proxmox</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Smart home server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparation">Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#edit-env-sh">Edit env.sh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#initialize-database">Initialize database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cleanup">Cleanup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stop-the-system">Stop the system</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cleanup-nextcloud">Cleanup nextcloud</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cleanup-adminer">Cleanup adminer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cleanup-postgres">Cleanup postgres</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-postgres">Initialization of postgres:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-adminer">Initialization of adminer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-nextcloud">Initialization of nextcloud:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#start-and-stop-normally">Start and stop normally</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zed/README.html">zed editor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Eccles</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Smart home server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/smart-home-server/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="smart-home-server">
<h1>Smart home server<a class="headerlink" href="#smart-home-server" title="Link to this heading"></a></h1>
<p>Ultimate smart home server.</p>
<p>This is a work in progress and git commits will reveal each stage of implementation.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.smarthomebeginner.com/docker-home-media-server-2018-basic/#OK_Great_but_why_build_a_Docker_Media_Server">https://www.smarthomebeginner.com/docker-home-media-server-2018-basic/#OK_Great_but_why_build_a_Docker_Media_Server</a></p></li>
</ul>
</section>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading"></a></h2>
<p>Install docker, docker-compose in Ubuntu server 24.04.</p>
<section id="edit-env-sh">
<h3>Edit <a class="reference external" href="http://env.sh">env.sh</a><a class="headerlink" href="#edit-env-sh" title="Link to this heading"></a></h3>
<p>Specify POSTGRESQL user and password.
Specify value of PLEX_CLAIM ( visit plex website to obtain…)</p>
<p>and create the .env file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./env.sh
</pre></div>
</div>
</section>
</section>
<section id="initialize-database">
<h2>Initialize database<a class="headerlink" href="#initialize-database" title="Link to this heading"></a></h2>
<p>The first start of the postgres container initializes the database which can take some
time. Initially one must bring up the various services individually until
initialization is complete. Once done one can simply start and stop using docker-compose
normally.</p>
<p>Postgres must be started individually once to initialize internal database.
Adminer is then started individually and access to postgres tested.
Nextcloud is then started individually to allow initialization of a second
database in Postgres.</p>
<section id="cleanup">
<h3>Cleanup<a class="headerlink" href="#cleanup" title="Link to this heading"></a></h3>
<p>If you have attempted to start the system without doing the initialization then some
cleanup is required.</p>
<section id="stop-the-system">
<h4>Stop the system<a class="headerlink" href="#stop-the-system" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>down<span class="w"> </span>--rmi<span class="w"> </span><span class="nb">local</span><span class="w"> </span>-v<span class="w"> </span>--remove-orphans
</pre></div>
</div>
</section>
<section id="cleanup-nextcloud">
<h4>Cleanup nextcloud<a class="headerlink" href="#cleanup-nextcloud" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>images<span class="w"> </span>nextcloud

<span class="w">    </span>REPOSITORY<span class="w">          </span>TAG<span class="w">                 </span>IMAGE<span class="w"> </span>ID<span class="w">            </span>CREATED<span class="w">             </span>SIZE
<span class="w">    </span>nextcloud<span class="w">           </span><span class="m">15</span><span class="w">                  </span>7f69ccc610f0<span class="w">        </span><span class="m">3</span><span class="w"> </span>days<span class="w"> </span>ago<span class="w">          </span>569MB
<span class="w">    </span>nextcloud<span class="w">           </span>latest<span class="w">              </span>7f69ccc610f0<span class="w">        </span><span class="m">3</span><span class="w"> </span>days<span class="w"> </span>ago<span class="w">          </span>569MB

docker<span class="w"> </span>image<span class="w"> </span>rm<span class="w"> </span>7f69ccc610f0

<span class="w">    </span>Error<span class="w"> </span>response<span class="w"> </span>from<span class="w"> </span>daemon:<span class="w"> </span>conflict:<span class="w"> </span>unable<span class="w"> </span>to<span class="w"> </span>delete<span class="w"> </span>7f69ccc610f0<span class="w"> </span><span class="o">(</span>must<span class="w"> </span>be<span class="w"> </span>forced<span class="o">)</span><span class="w"> </span>-<span class="w"> </span>image<span class="w"> </span>is<span class="w"> </span>referenced<span class="w"> </span><span class="k">in</span><span class="w"> </span>multiple<span class="w"> </span>repositories

docker<span class="w"> </span>image<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>7f69ccc610f0

<span class="w">    </span>Untagged:<span class="w"> </span>nextcloud:15
<span class="w">    </span>Untagged:<span class="w"> </span>nextcloud:latest
<span class="w">    </span>Untagged:<span class="w"> </span>nextcloud@sha256:a2f2bd57fcfd92b3b6c23b6f34f65d59c9b25e7cc883b1ac67fff01229325692
<span class="w">    </span>Deleted:<span class="w"> </span>sha256:7f69ccc610f0468f01106f40cb6b08f87b5e10a2627a765096dd5643ecef96d4
<span class="w">    </span>.....
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>nextcloud/html/*
</pre></div>
</div>
</section>
<section id="cleanup-adminer">
<h4>Cleanup adminer<a class="headerlink" href="#cleanup-adminer" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>images<span class="w"> </span>adminer

<span class="w">    </span>REPOSITORY<span class="w">          </span>TAG<span class="w">                 </span>IMAGE<span class="w"> </span>ID<span class="w">            </span>CREATED<span class="w">             </span>SIZE
<span class="w">    </span>adminer<span class="w">             </span><span class="m">4</span>.7<span class="w">                 </span>6a66678d1bcc<span class="w">        </span><span class="m">2</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">         </span><span class="m">81</span>.7MB

docker<span class="w"> </span>image<span class="w"> </span>rm<span class="w"> </span>6a66678d1bcc

<span class="w">    </span>Untagged:<span class="w"> </span>adminer:4.7
<span class="w">    </span>Untagged:<span class="w"> </span>adminer@sha256:26ed9238d44d2cc1aed8d760d2bdb7d03563f695a401ac58a929230301b18890
<span class="w">    </span>Deleted:<span class="w"> </span>sha256:6a66678d1bcc8fc5c618283272126f578c02250d2dfe580d9f9af1753fcf1d6e
<span class="w">    </span>.....
</pre></div>
</div>
</section>
<section id="cleanup-postgres">
<h4>Cleanup postgres<a class="headerlink" href="#cleanup-postgres" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>images<span class="w"> </span>postgres

<span class="w">    </span>REPOSITORY<span class="w">          </span>TAG<span class="w">                 </span>IMAGE<span class="w"> </span>ID<span class="w">            </span>CREATED<span class="w">             </span>SIZE
<span class="w">    </span>postgres<span class="w">            </span><span class="m">11</span>.1-alpine<span class="w">         </span>0c49db718c45<span class="w">        </span><span class="m">2</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">         </span><span class="m">71</span>.7MB

docker<span class="w"> </span>image<span class="w"> </span>rm<span class="w"> </span>0c49db718c45

<span class="w">    </span>Untagged:<span class="w"> </span>postgres:11.1-alpine
<span class="w">    </span>Untagged:<span class="w"> </span>postgres@sha256:d965830b5148308278118f131e352d4c19366a7933c35a01f190b97dca1ad7d4
<span class="w">    </span>Deleted:<span class="w"> </span>sha256:0c49db718c45f6df879711df7b88eda72e45aac8893c996665e08653959da45d
<span class="w">    </span>....
</pre></div>
</div>
<p>and remove any database files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>postgres/data/*
</pre></div>
</div>
</section>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading"></a></h3>
<section id="initialization-of-postgres">
<h4>Initialization of postgres:<a class="headerlink" href="#initialization-of-postgres" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>db

<span class="w">    </span>Creating<span class="w"> </span>network<span class="w"> </span><span class="s2">&quot;hestia_default&quot;</span><span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>driver
<span class="w">    </span>Pulling<span class="w"> </span>db<span class="w"> </span><span class="o">(</span>postgres:11.1-alpine<span class="o">)</span>...
<span class="w">    </span><span class="m">11</span>.1-alpine:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/postgres
<span class="w">    </span>cd784148e348:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>67451ade031c:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>a9990a72e3ae:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>cb46a6b8595e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>c4c5191c055e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>3eb34939ab82:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>74bf1f0d5492:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>d4fab745256a:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>da4cf5e8ded8:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>Creating<span class="w"> </span>hestia_db_1<span class="w"> </span>...<span class="w"> </span><span class="k">done</span>

docker-compose<span class="w"> </span>logs<span class="w"> </span>db

<span class="w">    </span>Attaching<span class="w"> </span>to<span class="w"> </span>hestia_db_1
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>files<span class="w"> </span>belonging<span class="w"> </span>to<span class="w"> </span>this<span class="w"> </span>database<span class="w"> </span>system<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>owned<span class="w"> </span>by<span class="w"> </span>user<span class="w"> </span><span class="s2">&quot;paul&quot;</span>.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>This<span class="w"> </span>user<span class="w"> </span>must<span class="w"> </span>also<span class="w"> </span>own<span class="w"> </span>the<span class="w"> </span>server<span class="w"> </span>process.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>database<span class="w"> </span>cluster<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>initialized<span class="w"> </span>with<span class="w"> </span>locale<span class="w"> </span><span class="s2">&quot;en_US.utf8&quot;</span>.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>default<span class="w"> </span>database<span class="w"> </span>encoding<span class="w"> </span>has<span class="w"> </span>accordingly<span class="w"> </span>been<span class="w"> </span><span class="nb">set</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;UTF8&quot;</span>.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>default<span class="w"> </span>text<span class="w"> </span>search<span class="w"> </span>configuration<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="nb">set</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;english&quot;</span>.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>Data<span class="w"> </span>page<span class="w"> </span>checksums<span class="w"> </span>are<span class="w"> </span>disabled.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>fixing<span class="w"> </span>permissions<span class="w"> </span>on<span class="w"> </span>existing<span class="w"> </span>directory<span class="w"> </span>/var/lib/postgresql/data<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>creating<span class="w"> </span>subdirectories<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>selecting<span class="w"> </span>default<span class="w"> </span>max_connections<span class="w"> </span>...<span class="w"> </span><span class="m">100</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>selecting<span class="w"> </span>default<span class="w"> </span>shared_buffers<span class="w"> </span>...<span class="w"> </span>128MB
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>selecting<span class="w"> </span>dynamic<span class="w"> </span>shared<span class="w"> </span>memory<span class="w"> </span>implementation<span class="w"> </span>...<span class="w"> </span>posix
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>creating<span class="w"> </span>configuration<span class="w"> </span>files<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>running<span class="w"> </span>bootstrap<span class="w"> </span>script<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>sh:<span class="w"> </span>locale:<span class="w"> </span>not<span class="w"> </span>found
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:40.546<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">19</span><span class="o">]</span><span class="w"> </span>WARNING:<span class="w">  </span>no<span class="w"> </span>usable<span class="w"> </span>system<span class="w"> </span>locales<span class="w"> </span>were<span class="w"> </span>found
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>performing<span class="w"> </span>post-bootstrap<span class="w"> </span>initialization<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>syncing<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span>disk<span class="w"> </span>...<span class="w"> </span>ok
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>Success.<span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>start<span class="w"> </span>the<span class="w"> </span>database<span class="w"> </span>server<span class="w"> </span>using:
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w">     </span>pg_ctl<span class="w"> </span>-D<span class="w"> </span>/var/lib/postgresql/data<span class="w"> </span>-l<span class="w"> </span>logfile<span class="w"> </span>start
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>WARNING:<span class="w"> </span>enabling<span class="w"> </span><span class="s2">&quot;trust&quot;</span><span class="w"> </span>authentication<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">local</span><span class="w"> </span>connections
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>change<span class="w"> </span>this<span class="w"> </span>by<span class="w"> </span>editing<span class="w"> </span>pg_hba.conf<span class="w"> </span>or<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>option<span class="w"> </span>-A,<span class="w"> </span>or
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>--auth-local<span class="w"> </span>and<span class="w"> </span>--auth-host,<span class="w"> </span>the<span class="w"> </span>next<span class="w"> </span><span class="nb">time</span><span class="w"> </span>you<span class="w"> </span>run<span class="w"> </span>initdb.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>server<span class="w"> </span>to<span class="w"> </span>start....2019-01-27<span class="w"> </span><span class="m">10</span>:10:41.307<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>listening<span class="w"> </span>on<span class="w"> </span>Unix<span class="w"> </span>socket<span class="w"> </span><span class="s2">&quot;/var/run/postgresql/.s.PGSQL.5432&quot;</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.348<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">24</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>database<span class="w"> </span>system<span class="w"> </span>was<span class="w"> </span>shut<span class="w"> </span>down<span class="w"> </span>at<span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41<span class="w"> </span>GMT
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.358<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>database<span class="w"> </span>system<span class="w"> </span>is<span class="w"> </span>ready<span class="w"> </span>to<span class="w"> </span>accept<span class="w"> </span>connections
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w">  </span><span class="k">done</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>server<span class="w"> </span>started
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>CREATE<span class="w"> </span>DATABASE
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>/usr/local/bin/docker-entrypoint.sh:<span class="w"> </span>ignoring<span class="w"> </span>/docker-entrypoint-initdb.d/*
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>server<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down....2019-01-27<span class="w"> </span><span class="m">10</span>:10:41.667<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>received<span class="w"> </span>fast<span class="w"> </span>shutdown<span class="w"> </span>request
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.670<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>aborting<span class="w"> </span>any<span class="w"> </span>active<span class="w"> </span>transactions
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.671<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>background<span class="w"> </span>worker<span class="w"> </span><span class="s2">&quot;logical replication launcher&quot;</span><span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">30</span><span class="o">)</span><span class="w"> </span>exited<span class="w"> </span>with<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>code<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.671<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">25</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>shutting<span class="w"> </span>down
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.711<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">23</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>database<span class="w"> </span>system<span class="w"> </span>is<span class="w"> </span>shut<span class="w"> </span>down
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w">  </span><span class="k">done</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>server<span class="w"> </span>stopped
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>PostgreSQL<span class="w"> </span>init<span class="w"> </span>process<span class="w"> </span>complete<span class="p">;</span><span class="w"> </span>ready<span class="w"> </span><span class="k">for</span><span class="w"> </span>start<span class="w"> </span>up.
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.785<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>listening<span class="w"> </span>on<span class="w"> </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span>,<span class="w"> </span>port<span class="w"> </span><span class="m">5432</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.785<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>listening<span class="w"> </span>on<span class="w"> </span>IPv6<span class="w"> </span>address<span class="w"> </span><span class="s2">&quot;::&quot;</span>,<span class="w"> </span>port<span class="w"> </span><span class="m">5432</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.801<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>listening<span class="w"> </span>on<span class="w"> </span>Unix<span class="w"> </span>socket<span class="w"> </span><span class="s2">&quot;/var/run/postgresql/.s.PGSQL.5432&quot;</span>
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.833<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">34</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>database<span class="w"> </span>system<span class="w"> </span>was<span class="w"> </span>shut<span class="w"> </span>down<span class="w"> </span>at<span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41<span class="w"> </span>GMT
<span class="w">    </span>db_1<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">2019</span>-01-27<span class="w"> </span><span class="m">10</span>:10:41.842<span class="w"> </span>GMT<span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>LOG:<span class="w">  </span>database<span class="w"> </span>system<span class="w"> </span>is<span class="w"> </span>ready<span class="w"> </span>to<span class="w"> </span>accept<span class="w"> </span>connections
</pre></div>
</div>
<p>Check the log output for any errors.</p>
</section>
<section id="initialization-of-adminer">
<h4>Initialization of adminer:<a class="headerlink" href="#initialization-of-adminer" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>adminer

<span class="w">    </span>Pulling<span class="w"> </span>adminer<span class="w"> </span><span class="o">(</span>adminer:4.7<span class="o">)</span>...
<span class="w">    </span><span class="m">4</span>.7:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/adminer
<span class="w">    </span>cd784148e348:<span class="w"> </span>Already<span class="w"> </span>exists
<span class="w">    </span>d207535cd57f:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>1167ab95319c:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>bff34bff7f50:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>152335cb99d2:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>4f4bb6b6c24e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>16f2cd41ff90:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>937eb7aa641a:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>2308779f1613:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>9321df607d85:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>d40abead42f8:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>40c5027dc3ef:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>453bc81e4ff6:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>49127472bf4e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>3cc4ea5dfc12:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>f378ce480f70:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>hestia_db_1<span class="w"> </span>is<span class="w"> </span>up-to-date
<span class="w">    </span>Creating<span class="w"> </span>hestia_adminer_1<span class="w"> </span>...<span class="w"> </span><span class="k">done</span>

docker-compose<span class="w"> </span>logs<span class="w"> </span>adminer

<span class="w">    </span>Attaching<span class="w"> </span>to<span class="w"> </span>hestia_adminer_1
<span class="w">    </span>adminer_1<span class="w">        </span><span class="p">|</span><span class="w"> </span>PHP<span class="w"> </span><span class="m">7</span>.2.14<span class="w"> </span>Development<span class="w"> </span>Server<span class="w"> </span>started<span class="w"> </span>at<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">10</span>:13:18<span class="w"> </span><span class="m">2019</span>
</pre></div>
</div>
<p>Point your browser to <a class="reference external" href="http://localhost">http://localhost</a>:<span class="math notranslate nohighlight">\({PORT_ADMINER} and check that one can login and see the \)</span>{POSTGRES_DB}
database.</p>
<ul class="simple">
<li><p>System: Postgresql</p></li>
<li><p>Server: db</p></li>
<li><p>Username: ${USER}</p></li>
<li><p>Password: ${POSTGRES_PASSWORD}</p></li>
<li><p>Database: ${POSTGRES_DB}</p></li>
</ul>
</section>
<section id="initialization-of-nextcloud">
<h4>Initialization of nextcloud:<a class="headerlink" href="#initialization-of-nextcloud" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>nextcloud

<span class="w">    </span>Pulling<span class="w"> </span>nextcloud<span class="w"> </span><span class="o">(</span>nextcloud:<span class="o">)</span>...
<span class="w">    </span>latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/nextcloud
<span class="w">    </span>5e6ec7f28fb7:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>cf165947b5b7:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>7bd37682846d:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>99daf8e838e1:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>ae320713efba:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>ebcb99c48d8c:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>9867e71b4ab6:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>936eb418164a:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>5d9617dfb66b:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>8dd7afaae109:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>8f207844da7e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>adb3ae5e4987:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>44d7d07029db:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>fb91064652b0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>50923e16d552:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>a7cb9c70c5d2:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>728e578e40fa:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>4c3163d09df1:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>842c4700643d:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>cc1964f4bb3e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>125e01596295:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
<span class="w">    </span>hestia_db_1<span class="w"> </span>is<span class="w"> </span>up-to-date
<span class="w">    </span>Creating<span class="w"> </span>hestia_nextcloud_1<span class="w"> </span>...<span class="w"> </span><span class="k">done</span>

docker-compose<span class="w"> </span>logs<span class="w"> </span>nextcloud

<span class="w">    </span>Attaching<span class="w"> </span>to<span class="w"> </span>hestia_nextcloud_1
<span class="w">    </span>nextcloud_1<span class="w">      </span><span class="p">|</span><span class="w"> </span>Initializing<span class="w"> </span>nextcloud<span class="w"> </span><span class="m">15</span>.0.2.0<span class="w"> </span>...
<span class="w">    </span>nextcloud_1<span class="w">      </span><span class="p">|</span><span class="w"> </span>Initializing<span class="w"> </span>finished
<span class="w">    </span>nextcloud_1<span class="w">      </span><span class="p">|</span><span class="w"> </span>New<span class="w"> </span>nextcloud<span class="w"> </span>instance
<span class="w">    </span>nextcloud_1<span class="w">      </span><span class="p">|</span><span class="w"> </span>Installing<span class="w"> </span>with<span class="w"> </span>PostgreSQL<span class="w"> </span>database
<span class="w">    </span>nextcloud_1<span class="w">      </span><span class="p">|</span><span class="w"> </span>starting<span class="w"> </span>nextcloud<span class="w"> </span>installation
</pre></div>
</div>
<p>Point your browser to <a class="reference external" href="http://localhost">http://localhost</a>:${PORT_ADMINER} and check that one can login and see the nextcloud
database.</p>
<ul class="simple">
<li><p>System: Postgresql</p></li>
<li><p>Server: db</p></li>
<li><p>Username: ${USER}</p></li>
<li><p>Password: ${POSTGRES_PASSWORD}</p></li>
<li><p>Database: nextcloud</p></li>
</ul>
<p>Point your browser to <a class="reference external" href="http://localhost">http://localhost</a>:${PORT_NEXTCLOUD} and check that one can login to nextcloud.</p>
<ul class="simple">
<li><p>User: ${NEXTCLOUD_ADMIN_USER}</p></li>
<li><p>Password: ${NEXTCLOUD_ADMIN_PASSWORD}</p></li>
</ul>
<p>If you get an untrusted domain message (if the nextcloud service is running on a server and you are accessing from
a desktop) then one has to add to trusted_domains.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>vi<span class="w"> </span>nextcloud/html/config/config.php

<span class="w">    </span>and<span class="w"> </span>add<span class="w"> </span>your<span class="w"> </span>server<span class="w"> </span>name<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>trusted<span class="w"> </span>domains<span class="w"> </span>array:

<span class="w">        </span>array<span class="w"> </span><span class="o">(</span>
<span class="w">          </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s1">&#39;localhost&#39;</span>,
<span class="w">          </span><span class="nv">1</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s1">&#39;your server name&#39;</span>,
<span class="w">        </span><span class="o">)</span>,

docker-compose<span class="w"> </span>restart<span class="w"> </span>nextcloud.
</pre></div>
</div>
<p>Currently there appears to be a bug in nextcloud as the Web UI does not currently
let me login as the ADMIN user.</p>
</section>
</section>
</section>
<section id="start-and-stop-normally">
<h2>Start and stop normally<a class="headerlink" href="#start-and-stop-normally" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>
docker-compose<span class="w"> </span>down<span class="w"> </span>--rmi<span class="w"> </span><span class="nb">local</span><span class="w"> </span>-v<span class="w"> </span>--remove-orphans
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../proxmox/README.html" class="btn btn-neutral float-left" title="Proxmox" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../zed/README.html" class="btn btn-neutral float-right" title="zed editor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Paul Hewlett.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>